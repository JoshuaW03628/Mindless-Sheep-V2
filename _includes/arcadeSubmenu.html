<table style="margin-top: -30px;">
    <tr style="text-align: center; vertical-align: middle;">
        <td><a href="{{ site.baseurl }}/" onclick="localStorage.clear()">Log Out</a></td>
        <td><a href="{{ site.baseurl }}/arcade/account">Account</a></td>
        <td><a href="{{ site.baseurl }}/arcade/reactionTime">Reaction Time</a></td>
        <td><a href="{{ site.baseurl }}/arcade/pong">Pong</a></td>
        <td><a href="{{ site.baseurl }}/arcade/snake">Snake</a></td>
        <td><a href="{{ site.baseurl }}/arcade/hiLo">Hi-Lo</a></td>
        <td><a href="{{ site.baseurl }}/arcade/leaderboard">Leaderboard</a></td>
        <td><span id="tokenCount">loading...</span> <img src="{{ site.baseurl }}/images/AJToken_60x60.png" style="display: inline; width: 18px; vertical-align:middle;"></td>
    </tr>
</table>
<script>
    // function that updates the token amount (database implementation needed)
    function tokenDisp() {
        // identify where the tokens must be displayed
        let elem = document.getElementById('tokenCount');

        // identify which user to access
        let currentUser = localStorage.getItem('currentUser');

        // Read the database
        fetch('https://ajarcade.duckdns.org/api/players/')
            .then(response => {
                // trap error response from Web API
                if (response.status !== 200) {
                    const message = 'Fetch error: ' + response.status + " " + response.statusText;
                    alert(message);
                    return;
                }
                // Valid response will contain json data
                response.json().then(data => {
                    // iterate through the whole database and find a record that matches the uid
                    for (i in data) {
                        if (data[i].uid == currentUser) {
                            const tokenAmt = data[i].tokens;
                            const tokenAmtA = Math.abs(tokenAmt);
                            if (tokenAmt > 0) {
                                elem.textContent = tokenAmt;
                            }
                            else if (tokenAmt < 0) {
                                elem.textContent = "In debt " + tokenAmtA;
                            }
                            else {
                                elem.textContent = "You're broke";
                            }
                        }
                    }
                })
            })
    };

    // update the token amount every 'x' seconds
    let x = 1;
    const updateLoop = setInterval("tokenDisp()", (x*1000))
</script>